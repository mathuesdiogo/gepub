# Generated by ChatGPT for GEPUB NEE enterprise patch
from __future__ import annotations

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
from django.utils import timezone


class Migration(migrations.Migration):
    dependencies = [
        ("nee", "0001_initial"),
        ("educacao", "0001_initial"),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        # Add premium fields without breaking existing data
        migrations.AddField(
            model_name="alunonecessidade",
            name="criado_em",
            field=models.DateTimeField(auto_now_add=True, default=timezone.now),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name="apoiomatricula",
            name="tipo",
            field=models.CharField(
                choices=[
                    ("AEE", "AEE (Atendimento Educacional Especializado)"),
                    ("CUIDADOR", "Cuidador(a)"),
                    ("INTERPRETE_LIBRAS", "Intérprete de Libras"),
                    ("PROFESSOR_APOIO", "Professor de Apoio"),
                    ("TRANSPORTE", "Transporte Adaptado"),
                    ("RECURSO", "Recurso/Adaptação"),
                    ("OUTRO", "Outro"),
                ],
                default="OUTRO",
                max_length=30,
            ),
        ),
        migrations.AddField(
            model_name="apoiomatricula",
            name="observacao",
            field=models.TextField(blank=True, default=""),
        ),
        migrations.AddField(
            model_name="apoiomatricula",
            name="criado_em",
            field=models.DateTimeField(auto_now_add=True, default=timezone.now),
            preserve_default=False,
        ),

        # New models
        migrations.CreateModel(
            name="LaudoNEE",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("numero", models.CharField(blank=True, default="", max_length=80)),
                ("data_emissao", models.DateField(default=timezone.localdate)),
                ("validade", models.DateField(blank=True, null=True)),
                ("profissional", models.CharField(blank=True, default="", max_length=180)),
                ("documento", models.FileField(blank=True, null=True, upload_to="nee/laudos/")),
                ("texto", models.TextField(blank=True, default="")),
                ("criado_em", models.DateTimeField(auto_now_add=True)),
                ("aluno", models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name="laudos_nee", to="educacao.aluno")),
            ],
            options={"ordering": ["-data_emissao", "-id"]},
        ),
        migrations.CreateModel(
            name="RecursoNEE",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("nome", models.CharField(max_length=180)),
                ("status", models.CharField(choices=[("ATIVO", "Ativo"), ("EM_AVALIACAO", "Em avaliação"), ("INATIVO", "Inativo")], default="ATIVO", max_length=20)),
                ("observacao", models.TextField(blank=True, default="")),
                ("criado_em", models.DateTimeField(auto_now_add=True)),
                ("aluno", models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name="recursos_nee", to="educacao.aluno")),
            ],
            options={"ordering": ["nome"]},
        ),
        migrations.CreateModel(
            name="AcompanhamentoNEE",
            fields=[
                ("id", models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name="ID")),
                ("data", models.DateField(default=timezone.localdate)),
                ("tipo_evento", models.CharField(choices=[("OBSERVACAO", "Observação"), ("ATENDIMENTO", "Atendimento"), ("EVOLUCAO", "Evolução"), ("INTERVENCAO", "Intervenção"), ("DOCUMENTO", "Documento")], default="OBSERVACAO", max_length=20)),
                ("descricao", models.TextField()),
                ("visibilidade", models.CharField(choices=[("EQUIPE", "Equipe (NEE/Saúde)"), ("GESTAO", "Gestão (Secretaria/Unidade)")], default="EQUIPE", max_length=20)),
                ("criado_em", models.DateTimeField(auto_now_add=True)),
                ("aluno", models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name="acompanhamentos_nee", to="educacao.aluno")),
                ("autor", models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name="acompanhamentos_nee", to=settings.AUTH_USER_MODEL)),
            ],
            options={"ordering": ["-data", "-id"]},
        ),

        # Indexes (safe)
        migrations.AddIndex(
            model_name="alunonecessidade",
            index=models.Index(fields=["aluno"], name="nee_alunone_aluno_i"),
        ),
        migrations.AddIndex(
            model_name="alunonecessidade",
            index=models.Index(fields=["tipo"], name="nee_alunone_tipo_i"),
        ),
        migrations.AddIndex(
            model_name="alunonecessidade",
            index=models.Index(fields=["ativo"], name="nee_alunone_ativo_i"),
        ),
        migrations.AddIndex(
            model_name="apoiomatricula",
            index=models.Index(fields=["tipo"], name="nee_apoiom_tipo_i"),
        ),
        migrations.AddIndex(
            model_name="apoiomatricula",
            index=models.Index(fields=["ativo"], name="nee_apoiom_ativo_i"),
        ),
    ]
