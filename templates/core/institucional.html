{% extends "core/base_public.html" %}
{% load static %}

{% block title %}{{ content.marca_nome|default:'GEPUB' }} • Gestão Estratégica Pública{% endblock %}

{% block extra_head %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Sora:wght@500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="{% static 'css/pages/institucional.css' %}">
{% endblock %}

{% block content %}
<div class="ins-page" id="topo">
  {% if preview_mode %}
    <div class="ins-preview-banner">
      Visualização do editor institucional (modo preview).
      <a href="{% url 'core:institutional_admin' %}">Voltar ao editor</a>
    </div>
  {% endif %}

  <header class="ins-header">
    <div class="ins-wrap ins-header__inner">
      <a class="ins-brand" href="#topo">
        <span class="ins-brand__mark">
          {% if content.marca_logo_url %}
            <img src="{{ content.marca_logo_url }}" alt="{{ content.marca_nome|default:'GEPUB' }}" class="ins-brand__logo">
          {% else %}
            <i class="fa-solid fa-building-columns"></i>
          {% endif %}
        </span>
        <span>
          <strong>{{ content.marca_nome|default:'GEPUB' }}</strong>
          <small>Gestão Estratégica Pública</small>
        </span>
      </a>

      <nav class="ins-nav" aria-label="Navegação institucional">
        <a href="#ferramentas">{{ content.nav_servicos_label|default:'Serviços' }}</a>
        <a href="#metodo">{{ content.nav_metodo_label|default:'Método' }}</a>
        <a href="#modulos">Módulos</a>
        <a href="#planos">{{ content.nav_planos_label|default:'Planos' }}</a>
        <a href="#simulador">{{ content.nav_simulador_label|default:'Simulador' }}</a>
      </nav>

      <div class="ins-header__actions">
        <a class="ins-btn ins-btn--ghost" href="{{ cta_login }}">{{ content.botao_login_label|default:'Entrar' }}</a>
        <a class="ins-btn ins-btn--primary" href="{{ cta_contato }}">Agendar Demo</a>
      </div>
    </div>
  </header>

  <main class="ins-main">
    <section class="ins-hero">
      <div class="ins-wrap ins-hero__inner">
        <article class="ins-hero__content reveal-up" style="--d:.02s;">
          <p class="ins-kicker">{{ content.hero_kicker|default:'GEPUB' }}</p>
          <h1>{{ content.hero_titulo|default:'Tecnologia inteligente para gestão pública municipal' }}</h1>
          <p>{{ content.hero_descricao|default:'Plataforma integrada para organizar secretarias, ampliar transparência e acelerar resultados da prefeitura.' }}</p>

          <div class="ins-hero__actions">
            <a class="ins-btn ins-btn--primary" href="{{ content.hero_cta_primario_link|default:'#simulador' }}">{{ content.hero_cta_primario_label|default:'Simular plano' }}</a>
            <a class="ins-btn ins-btn--soft" href="{{ content.hero_cta_secundario_link|default:'#planos' }}">{{ content.hero_cta_secundario_label|default:'Ver planos' }}</a>
          </div>

          <div class="ins-hero__trusted">
            <span>Ecossistema integrado:</span>
            <div class="ins-hero__icons">
              {% for service in service_cards|slice:':7' %}
                <i class="{{ service.icone|default:'fa-solid fa-cube' }}" title="{{ service.titulo }}"></i>
              {% endfor %}
            </div>
          </div>
        </article>

        <aside class="ins-hero__visual reveal-up" style="--d:.08s;">
          {% with first=slides.0 second=slides.1 third=slides.2 %}
            <article class="ins-bubble ins-bubble--main">
              {% if first and first.imagem_url %}
                <img src="{{ first.imagem_url }}" alt="{{ first.titulo }}">
              {% else %}
                <span><i class="fa-solid fa-user-tie"></i></span>
              {% endif %}
            </article>

            <article class="ins-bubble ins-bubble--secondary">
              {% if second and second.imagem_url %}
                <img src="{{ second.imagem_url }}" alt="{{ second.titulo }}">
              {% else %}
                <span><i class="fa-solid fa-users"></i></span>
              {% endif %}
            </article>

            {% if first %}
              <article class="ins-float-card is-top">
                <strong>{{ first.titulo }}</strong>
                {% if first.subtitulo %}<p>{{ first.subtitulo }}</p>{% endif %}
              </article>
            {% endif %}

            {% if second %}
              <article class="ins-float-card is-mid">
                <strong>{{ second.titulo }}</strong>
                {% if second.subtitulo %}<p>{{ second.subtitulo }}</p>{% endif %}
              </article>
            {% endif %}

            {% if third %}
              <article class="ins-float-card is-bottom">
                <strong>{{ third.titulo }}</strong>
                {% if third.subtitulo %}<p>{{ third.subtitulo }}</p>{% endif %}
              </article>
            {% endif %}

            <article class="ins-score-card">
              <p>Operação única para o município</p>
              <div>
                <strong>{{ service_cards|length }}</strong>
                <span>módulos conectados</span>
              </div>
            </article>
          {% endwith %}
        </aside>
      </div>
    </section>

    <section class="ins-section" id="ferramentas">
      <div class="ins-wrap reveal-up" style="--d:.12s;">
        <div class="ins-section__head ins-section__head--center">
          <p class="ins-kicker">{{ content.servicos_kicker|default:'Nossos serviços' }}</p>
          <h2>Todas as ferramentas que sua gestão precisa</h2>
          <p>{{ content.servicos_titulo|default:'Solução completa para operação pública integrada, com governança e transparência.' }}</p>
        </div>

        <article class="ins-platform-shot">
          <img src="{% static 'img/design-admin-panel-ui-ux-for-web-app-saas-dashboard-software-in-figma-or-xd.webp' %}" alt="Painel administrativo GEPUB">
        </article>

        <div class="ins-service-chips">
          {% for service in service_cards %}
            <article>
              <i class="{{ service.icone|default:'fa-solid fa-cube' }}"></i>
              <span>{{ service.titulo }}</span>
            </article>
          {% endfor %}
        </div>
      </div>
    </section>

    <section class="ins-section ins-section--split" id="metodo">
      <div class="ins-wrap ins-split reveal-up" style="--d:.16s;">
        <article>
          <p class="ins-kicker">{{ content.metodo_kicker|default:'Método GEPUB' }}</p>
          <h2>{{ content.metodo_titulo|default:'Implantação orientada por etapas e metas.' }}</h2>
          <p>{{ content.oferta_descricao|default:'Do diagnóstico ao onboarding com suporte contínuo para a prefeitura.' }}</p>

          <ul class="ins-checklist">
            {% for step in method_steps %}
              <li>
                <i class="{{ step.icone|default:'fa-solid fa-check' }}"></i>
                <div>
                  <strong>{{ step.titulo }}</strong>
                  <p>{{ step.descricao }}</p>
                </div>
              </li>
            {% endfor %}
          </ul>

          <a class="ins-link" href="{{ content.metodo_cta_link|default:'#simulador' }}">{{ content.metodo_cta_label|default:'Quero avaliar meu município' }} <i class="fa-solid fa-arrow-right"></i></a>
        </article>

        <article class="ins-media-stack">
          <div class="ins-media-stack__main">
            {% if slides and slides.0.imagem_url %}
              <img src="{{ slides.0.imagem_url }}" alt="{{ slides.0.titulo }}">
            {% else %}
              <img src="{% static 'img/design-admin-panel-ui-ux-for-web-app-saas-dashboard-software-in-figma-or-xd.webp' %}" alt="Visão geral GEPUB">
            {% endif %}
            <button type="button" aria-label="Assistir apresentação">
              <i class="fa-solid fa-play"></i>
            </button>
          </div>
          <div class="ins-media-stack__cards">
            {% for slide in slides|slice:':3' %}
              <article>
                <strong>{{ slide.titulo }}</strong>
                <p>{{ slide.descricao|default:slide.subtitulo }}</p>
                <a href="{{ slide.cta_link|default:cta_docs }}">{{ slide.cta_label|default:'Saber mais' }}</a>
              </article>
            {% endfor %}
          </div>
        </article>
      </div>
    </section>

    <section class="ins-section" id="modulos">
      <div class="ins-wrap ins-split reveal-up" style="--d:.20s;">
        <article class="ins-gallery-grid">
          {% for slide in slides|slice:':8' %}
            <div>
              {% if slide.imagem_url %}
                <img src="{{ slide.imagem_url }}" alt="{{ slide.titulo }}">
              {% else %}
                <span><i class="{{ slide.icone|default:'fa-solid fa-cube' }}"></i></span>
              {% endif %}
            </div>
          {% endfor %}
          {% if not slides %}
            {% for service in service_cards|slice:':8' %}
              <div><span><i class="{{ service.icone|default:'fa-solid fa-cube' }}"></i></span></div>
            {% endfor %}
          {% endif %}
        </article>

        <article>
          <p class="ins-kicker">Integração total</p>
          <h2>Secretarias, equipes e dados em uma única plataforma</h2>
          <p>{{ content.oferta_titulo|default:'Estrutura preparada para contratação pública e operação contínua.' }}</p>

          <div class="ins-feature-list">
            {% for service in service_cards|slice:':6' %}
              <p><i class="{{ service.icone|default:'fa-solid fa-check' }}"></i> {{ service.titulo }}: {{ service.descricao }}</p>
            {% endfor %}
          </div>

          <a class="ins-link" href="{{ cta_docs }}">Explorar módulos e documentação <i class="fa-solid fa-arrow-right"></i></a>
        </article>
      </div>
    </section>

    <section class="ins-stats reveal-up" style="--d:.24s;">
      <div class="ins-wrap ins-stats__grid">
        <article>
          <i class="fa-solid fa-layer-group"></i>
          <strong>{{ planos|length }}</strong>
          <span>planos municipais</span>
        </article>
        <article>
          <i class="fa-solid fa-cubes"></i>
          <strong>{{ service_cards|length }}</strong>
          <span>módulos integrados</span>
        </article>
        <article>
          <i class="fa-solid fa-list-check"></i>
          <strong>{{ method_steps|length }}</strong>
          <span>etapas de implantação</span>
        </article>
      </div>
    </section>

    <section class="ins-section" id="depoimentos">
      <div class="ins-wrap reveal-up" style="--d:.28s;">
        <div class="ins-section__head">
          <h2>O que os gestores perguntam</h2>
        </div>

        <div class="ins-testimonial-grid">
          {% for item in faq_items %}
            <article>
              <p>{{ item.pergunta }}</p>
              <strong>{{ item.resposta }}</strong>
            </article>
          {% endfor %}
        </div>
      </div>
    </section>

    <section class="ins-section" id="planos">
      <div class="ins-wrap reveal-up" style="--d:.32s;">
        <div class="ins-section__head">
          <p class="ins-kicker">{{ content.planos_kicker|default:'Planos municipais' }}</p>
          <h2>{{ content.planos_titulo|default:'Planos para diferentes portes de município' }}</h2>
          <p>{{ content.planos_descricao|default:'Modelos de contratação estruturados para escala e previsibilidade.' }}</p>
        </div>

        <div class="ins-plan-grid">
          {% for plano in planos %}
            <article class="ins-plan-card {% if plano.destaque == 'Recomendado' %}is-featured{% endif %}">
              <div class="ins-plan-card__head">
                {% if plano.destaque %}<span>{{ plano.destaque }}</span>{% endif %}
                <h3>{{ plano.nome }}</h3>
                <p>{{ plano.descricao }}</p>
              </div>

              <ul>
                {% for feature in plano.features|slice:':5' %}
                  <li>{{ feature }}</li>
                {% endfor %}
              </ul>

              <div class="ins-plan-card__price">R$ {{ plano.preco }}/mês</div>
              <a class="ins-btn ins-btn--soft" href="{{ cta_contato }}">Solicitar proposta</a>
            </article>
          {% empty %}
            <article class="ins-plan-card">
              <h3>Sem planos ativos</h3>
              <p>Cadastre planos no módulo Billing para exibir nesta seção.</p>
            </article>
          {% endfor %}
        </div>
      </div>
    </section>

    <section class="ins-sim" id="contato">
      <div class="ins-wrap reveal-up" style="--d:.36s;">
        <div class="ins-sim__box" id="simulador">
          <div class="ins-sim__intro">
            <p class="ins-kicker">Simulador GEPUB</p>
            <h2>Entre para uma gestão orientada por dados</h2>
            <p>Faça uma estimativa inicial do plano ideal para seu município e receba uma proposta técnica.</p>
          </div>

          <form method="post" class="ins-sim-form">
            {% csrf_token %}
            {% for field in form %}
              <div class="ins-sim-form__field">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                {{ field }}
                {% if field.errors %}<p class="ins-sim-form__error">{{ field.errors|striptags }}</p>{% endif %}
              </div>
            {% endfor %}
            <button class="ins-btn ins-btn--primary" type="submit">Simular plano</button>
          </form>

          {% if simulacao %}
            <div class="ins-sim-result">
              <article>
                <span>Plano recomendado</span>
                <strong>{{ simulacao.plano.nome }}</strong>
                <p>{{ simulacao.justificativa }}</p>
              </article>
              <article>
                <span>Base mensal</span>
                <strong>R$ {{ simulacao.preco_base }}</strong>
                <p>Sem adicionais</p>
              </article>
              <article>
                <span>Total estimado</span>
                <strong>R$ {{ simulacao.total_mensal }}</strong>
                <p>Adicionais: R$ {{ simulacao.total_adicionais }}</p>
              </article>
            </div>

            <div class="ins-sim-table-wrap">
              <table class="ins-sim-table">
                <thead>
                  <tr>
                    <th>Item</th>
                    <th>Quantidade</th>
                    <th>Valor unitário</th>
                    <th>Total</th>
                  </tr>
                </thead>
                <tbody>
                  {% for a in simulacao.adicionais %}
                    <tr>
                      <td>{{ a.nome }}</td>
                      <td>{{ a.quantidade }}</td>
                      <td>R$ {{ a.valor_unitario }}</td>
                      <td>R$ {{ a.valor_total }}</td>
                    </tr>
                  {% empty %}
                    <tr><td colspan="4">Sem adicionais para este cenário.</td></tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% endif %}
        </div>
      </div>
    </section>
  </main>

  <footer class="ins-footer">
    <div class="ins-wrap ins-footer__inner">
      <a class="ins-brand" href="#topo">
        <span class="ins-brand__mark">
          {% if content.marca_logo_url %}
            <img src="{{ content.marca_logo_url }}" alt="{{ content.marca_nome|default:'GEPUB' }}" class="ins-brand__logo">
          {% else %}
            <i class="fa-solid fa-building-columns"></i>
          {% endif %}
        </span>
        <span>
          <strong>{{ content.marca_nome|default:'GEPUB' }}</strong>
          <small>Gestão Estratégica Pública</small>
        </span>
      </a>

      <nav>
        <a href="#topo">Início</a>
        <a href="#modulos">Módulos</a>
        <a href="#planos">Planos</a>
        <a href="{{ cta_transparencia }}">Transparência</a>
        <a href="{{ cta_login }}">Sistema Interno</a>
      </nav>

      <p>{{ content.rodape_texto|default:'© GEPUB • Gestão Estratégica Pública. Todos os direitos reservados.' }}</p>
    </div>
  </footer>
</div>
{% endblock %}
