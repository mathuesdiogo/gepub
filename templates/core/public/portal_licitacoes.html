{% extends "core/public/base_portal_tenant.html" %}

{% block hero_text %}
<p>Processos licitatórios publicados automaticamente a partir da área administrativa de compras.</p>
{% endblock %}

{% block page_content %}
<section class="pp-grid pp-grid--3 pp-section-space">
  <article class="pp-card pp-kpi-card">
    <h3>Total de processos</h3>
    <p class="pp-kpi-value">{{ indicadores.total }}</p>
  </article>
  <article class="pp-card pp-kpi-card pp-kpi-card--deep">
    <h3>Em curso</h3>
    <p class="pp-kpi-value">{{ indicadores.em_curso }}</p>
  </article>
  <article class="pp-card pp-kpi-card pp-kpi-card--green">
    <h3>Homologados</h3>
    <p class="pp-kpi-value">{{ indicadores.homologado }}</p>
  </article>
</section>

<section class="pp-card pp-section-space">
  <form method="get" class="pp-form-inline">
    <div>
      <label for="id_q">Busca</label>
      <input id="id_q" class="pp-input" type="text" name="q" value="{{ q }}" placeholder="Número, objeto ou vencedor">
    </div>
    <div>
      <label for="id_modalidade">Modalidade</label>
      <select id="id_modalidade" class="pp-select" name="modalidade">
        <option value="">Todas</option>
        {% for value, label in modalidades %}
          <option value="{{ value }}" {% if modalidade == value %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label for="id_status">Status</label>
      <select id="id_status" class="pp-select" name="status">
        <option value="">Todos</option>
        {% for value, label in status_choices %}
          <option value="{{ value }}" {% if status == value %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label>&nbsp;</label>
      <div class="pp-actions">
        <button class="pp-btn pp-btn--primary" type="submit">Filtrar</button>
        <a class="pp-btn pp-btn--soft" href="{% url 'core:portal_licitacoes_public' %}">Limpar</a>
      </div>
    </div>
  </form>

  <div class="pp-table-wrap pp-section-space">
    <table class="pp-table">
      <thead>
        <tr>
          <th>Número</th>
          <th>Modalidade</th>
          <th>Objeto</th>
          <th>Status</th>
          <th>Data abertura</th>
          <th>Vencedor</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
          <tr>
            <td>{{ item.numero_processo }}</td>
            <td>{{ item.get_modalidade_display }}</td>
            <td>{{ item.objeto }}</td>
            <td>{{ item.get_status_display }}</td>
            <td>{{ item.data_abertura|date:"d/m/Y" }}</td>
            <td>{{ item.vencedor_nome|default:"—" }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="6">Nenhum processo licitatório publicado.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
